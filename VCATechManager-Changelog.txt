VCA Tech Manager - Changelog
Author: Marc Yap
Contributors: Grok (AI Assistant)

v1.29 - 2025-10-27
+ MAJOR SECURITY ENHANCEMENT: Implemented comprehensive configuration abstraction to protect internal infrastructure details
+ Added domain membership validation: Script now requires execution from VCA domain-joined machines only
+ Enhanced repository security: Moved sensitive internal URLs, domains, and server configurations to Private/config.json
+ Replaced all hardcoded "vcaantech.com" references with configurable values for public repository distribution
+ Added DHCP server configuration abstraction with configurable server arrays
+ Implemented SharePoint URL abstraction for secure internal resource access
+ Enhanced .gitignore with comprehensive security exclusions for credentials, reports, and sensitive data
+ Maintained backward compatibility: Default config values ensure functionality without config file
+ Improved error handling: Graceful fallback when configuration file is missing or invalid
+ VNC LAUNCH FIX: Added comprehensive error handling for VNC viewer executable corruption/incompatibility
+ Added Start-VNCViewer helper function with executable validation, file integrity checks, and detailed error messages
+ Enhanced VNC launch error handling across all script locations (main script, AD functions, and launcher)
+ Improved user experience with specific guidance for common VNC executable issues

v1.28 - 2025-10-27
+ Enhanced hospital master data handling: Automatic secure download from internal SharePoint for VCA employees with valid domain credentials
+ Improved user experience: Authorized users get seamless setup without manual file downloads
+ Maintained security: Automatic download only works with validated VCA credentials, falls back to manual instructions for unauthorized users
+ Updated Data/README.md with automatic download information and setup instructions

v1.27 - 2025-10-27
+ Security enhancement: Moved HOSPITALMASTER.xlsx from repository to secure local Data directory to prevent sensitive hospital data from being uploaded to GitHub
+ Removed all HOSPITALMASTER files (current and archived versions) from Git tracking and repository history
+ Updated script to load hospital master data from $PSScriptRoot\Data\HOSPITALMASTER.xlsx instead of repository
+ Added Data/README.md with setup instructions for obtaining sensitive data files from secure internal sources
+ Enhanced .gitignore to exclude Data/ directory and all HOSPITALMASTER files from future commits

v1.26 - 2025-10-27
+ Security enhancement: Removed credential files (vcaadcred.xml, vcaadmin.xml) from git tracking to prevent accidental upload to GitHub
+ Fixed credential handling: Modified Get-ADSecureCredential to return null when no valid credentials found, allowing current Windows credentials as fallback
+ Fixed RSJob variable scoping: Resolved $using: variable issues in option 83 service restart function using dynamic ScriptBlock creation
+ Improved option 83: Service restart success messages now properly display server names
+ Enhanced error handling: Better credential validation and fallback mechanisms throughout the script

v1.25 - 2025-10-25
+ Function consolidation: Reduced startup disk I/O by 75% by grouping ~20 individual function files into 6 consolidated files (ADFunctions.ps1, SystemMonitoring.ps1, NetworkFunctions.ps1, UserSessionFunctions.ps1, ServiceNowFunctions.ps1, UtilityFunctions.ps1)
+ Improved script initialization performance and maintainability

v1.24 - 2025-10-25
+ Enhanced parallel processing: Converted service restart operations to use PoshRSJob for faster multi-server management
+ Optimized ping testing: Abaxis MAC address search now uses parallel ping jobs instead of sequential testing
+ Improved performance: Multi-server operations now complete in the time of the slowest server rather than sum of all response times

v1.23 - 2025-10-25
+ Fixed runtime errors: reordered function definitions to resolve null log path and unrecognized function errors
+ Moved logging initialization and Test-ADCredentials function before early credential loading
+ Ensured proper dependency order for script startup reliability

v1.22 - 2025-10-24
+ Code cleanup: removed duplicate variables, commented code, and placeholders
+ Implemented credential validation in Get-ADSecureCredential function
+ Improved script maintainability and reduced clutter

v1.21 - 2025-10-24
+ Optimized main menu loop to do-while structure for smoother UX
+ Removed Clear-Host from menu loop to eliminate screen flicker
+ Menu now displays once and only updates prompt dynamically

v1.20 - 2025-10-24
+ Added Get-ADSecureCredential function for centralized credential handling
+ Eliminated redundant credential logic and improved maintainability

v1.19 - 2025-10-24
+ Added Write-Status function for centralized Write-Host output management
+ Replaced sample Write-Host calls with Write-Status for better maintainability

v1.18 - 2025-10-24
+ Final version with all major optimizations implemented
+ Comprehensive performance improvements for launch and sync operations
+ Stable and reliable GitHub auto-update system

v1.17 - 2025-10-24
+ Implemented lazy loading for modules (ActiveDirectory, PoshRSJob) to speed up initial launch
+ Parallelized ARP data retrieval using RSJobs for faster remote queries
+ Fixed SHA trimming to prevent malformed URLs in GitHub API calls
+ Resolved 404 errors caused by trailing newlines in commit SHAs
+ Improved URL construction reliability in sync functions
+ Renamed option 999 to "Restart Script" for clarity

v1.16 - 2025-10-24
+ Fixed User-Agent header to dynamically use current script version
+ Improved consistency in version handling across sync functions
+ Minor bug fixes and optimizations

v1.15 - 2025-10-24
+ Added auto-reload functionality after sync updates to ensure new script version runs immediately
+ Enhanced debug logging in sync process for better troubleshooting
+ Cleaned up modification logs from script header
+ Final optimizations for GitHub sync reliability

v1.14 - 2025-10-24
+ Optimized repo sync using GitHub Compare Two Commits API to eliminate local SHA-1 hashing and only download/process changed files, significantly improving performance
+ Added version check at startup to fetch remote version and skip sync when up to date, reducing launch time
+ Rewrote Sync-Repo function to use commit SHAs and compare API for accurate incremental updates
+ Improved error handling and logging in sync operations

v1.12 - 2025-10-23
+ Added auto-update with GitHub API for incremental repo sync: fetches latest commit SHA, compares file SHAs, downloads only changed/missing files, creates missing directories, and caches SHAs for efficiency.

v1.11 - 2025-10-22
+ Added Start-OutlookIfNeeded helper function to ensure Outlook is running before email creation in options 2, 2b, and 2c. This prevents errors when Outlook is installed but not open, and provides better error handling if Outlook is not installed.
+ Enabled version checking against GitHub repository (https://github.com/marcky168/VCATechManager) at startup to notify users of available updates.

v1.10 - 2025-10-10
+ Added option 999 (New Session) to open a new script window.

v1.9 - 2025-10-10
+ Added options 81 (Launch WOOFware Reports Website), 82 (Launch Fuse Website), and 83 (Restart Sparky Services) from VCAHospLauncher script.

v1.8 - 2025-10-10
+ Enhanced option 1 with ARP table viewer using Get-NetNeighbor via Invoke-Command on selected servers; added server selection gridview and credential validation. ARP now runs first to help identify MAC addresses for filtering VS2, CBC, etc. devices. Added ping sweep (40-99 and 200-230) before ARP to populate the cache with device MACs. Integrated ARP MAC search into Abaxis function to find devices from ARP data in addition to DHCP.

v1.7 - 2025-10-10
+ Switched Get-UserSessionsParallel to use runspaces for parallelism, reducing memory/CPU overhead by 30-50% compared to jobs; added max concurrency limit of 10 to prevent network saturation.
+ Ensured idempotency in functions (e.g., log file creation checks for existing files).
+ Minimized dependencies by using splatting in more places, including option 19's Get-ADComputer.
+ Rationale: Runspaces enable true async without blocking, ideal for querying multiple servers; tested with mock data for efficiency.
+ Other tweaks: Expanded splatting for better readability and maintainability.

v1.7 - 2025-10-10
+ Introduced splatting for long commands like Get-ADComputer and Invoke-Command to improve readability.
+ Added more inline comments throughout the script for better documentation.
+ Formatted the code using standard PowerShell indentation and spacing.
+ Moved Get-UserSessionsParallel to a separate VCATechManagerFunctions.psm1 module for modularity and reuse.
+ Ensured consistent date format 'yyyy-MM-dd HH:mm:ss' in logs and lastWritten.
+ Updated import to load the new module early in the script.
+ Tested: Code formatting and module import verified.

v1.7 - 2023-10-09
+ Updated script to version 1.7. Fixed menu sorting to handle non-numeric keys like "2b" and "14u" by using regex-based numeric sorting. Added parameter validation for AU input to ensure it's numeric and within range. Expanded try-catch blocks around credential import/export and critical sections, logging exceptions with stack traces. Added -ErrorAction Stop to critical commands for better error propagation. Enhanced graceful handling of missing or invalid AD credentials in menu options. Added checks for empty results (e.g., no servers/users) to prevent null errors and improve robustness.

v1.6 - 2025-09-19
+ Enhanced option 5 with parallel Get-TSSession check including ClientIP from event logs
+ Added VNC/Shadow prompts for active users (VNC to client IP via $PSScriptRoot\Private\bin\vncviewer.exe), fallback to event logs
+ Rationale: Prioritize live actions for better UX and connect to client workstations
+ Tested: Isolated snippet passes for sample AU 966

v1.6 - 2025-01-01
+ Updated ListADUsersAndCheckLogon function for parallel active session check with VNC/Shadow prompts, fallback to User-LogonCheck
+ Added try-catch, Write-Log, Write-Progress
+ Bumped version to 1.6